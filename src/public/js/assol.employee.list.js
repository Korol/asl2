$(document).ready(function(){var b=1,d=1;$.Employees={Init:function(){this.InitActions();this.InitDynamicData();this.InitTemplate()},InitActions:function(){$(document).on("click",".action-blocked-employee",function(a){var b=$(a.target).closest(".employee-wrap").attr("id-employee"),c=$(a.target).prop("checked");bootbox.confirm((c?"\u0417\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c":"\u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c")+" \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0430 \u2116<strong>"+
b+"</strong>?",function(f){f?$.Employees.SaveBlock(b,c):$(a.target).prop("checked",!c)})});$(document).on("click","#EmployeesStatus input:radio",function(a){$("#CurrentPage").val(1);$("#CurrentPageTop").val(1);$.Employees.ReloadEmployeesList()});$(document).on("click","#UserRole input:radio",function(a){$("#CurrentPage").val(1);$("#CurrentPageTop").val(1);$.Employees.ReloadEmployeesList()});$(document).on("click","#FilterSite input:radio",function(a){$("#CurrentPage").val(1);$("#CurrentPageTop").val(1);
$.Employees.ReloadEmployeesList()});$(document).on("keyup",".filter-input",function(a){delay(function(){$("#CurrentPage").val(1);$("#CurrentPageTop").val(1);$.Employees.ReloadEmployeesList()},500)});$(document).on("keyup","#CurrentPage",function(a){delay(function(){$.Employees.ReloadEmployeesList()},500)});$(document).on("keyup","#CurrentPageTop",function(a){delay(function(){$.Employees.ReloadEmployeesList()},500)});$(".assol-pagination-arrs .next").click(function(){$("#CurrentPage").val((parseInt($("#CurrentPage").val())||
0)+1);$("#CurrentPageTop").val((parseInt($("#CurrentPageTop").val())||0)+1);$.Employees.ReloadEmployeesList()});$(".assol-pagination-arrs .prev").click(function(){$("#CurrentPage").val((parseInt($("#CurrentPage").val())||0)-1);$("#CurrentPageTop").val((parseInt($("#CurrentPageTop").val())||0)-1);$.Employees.ReloadEmployeesList()})},InitDynamicData:function(){this.ReloadEmployeesList()},InitTemplate:function(){$("#employeeTemplate").template("employeeTemplate")},ReloadEmployeesList:function(){this.ReloadData("#employees",
"employeeTemplate")},ReloadData:function(a,e){$(a).html('<span class="load-inform">\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445...</span>');d=parseInt($("#CurrentPage").val())||0;1>d&&($("#CurrentPage").val(1),$("#CurrentPageTop").val(1));d>b&&($("#CurrentPage").val(b),$("#CurrentPageTop").val(b));var c={Status:$("#EmployeesStatus").find("input:radio:checked").val(),FIO:$("#FilterFIO").val(),UserRole:$("#UserRole").find("input:radio:checked").val(),Site:$("#FilterSite").find("input:radio:checked").val(),
Limit:20,Offset:20*(($("#CurrentPage").val()||1)-1)};$.post(BaseUrl+"employee/data",{data:c},function(c){c.status?(c.data.records&&($(a).empty(),$.tmpl(e,c.data.records).appendTo(a)),b=Math.ceil(c.data.count/20)||1,d=parseInt($("#CurrentPage").val())||1,d>b&&($("#CurrentPage").val(1),$("#CurrentPageTop").val(1)),$("#CountPage").html(b),$("#CountPageTop").html(b)):showErrorAlert(c.message)},"json")},SaveBlock:function(a,b){$.post(BaseUrl+"employee/"+a+"/update",{data:{IsBlocked:b?1:0}},function(a){a.status?
$.Employees.ReloadEmployeesList():showErrorAlert(a.message)},"json")}};$.Employees.Init()});
